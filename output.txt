The system administrator checked the Apache2 service, confirming it is active and running. Examination of the Nextcloud Apache error logs revealed repeated PHP fatal errors related to memcache configuration, specifically indicating that the Redis and APCu memcache modules are either missing or not properly enabled. Despite the PHP modules for apcu and redis being installed (confirmed via `php -m`), Nextcloud logs show class redeclaration errors and memcache availability exceptions in `/var/www/nextcloud/lib/private/Memcache/Factory.php`. The Nextcloud maintenance repair command was run successfully, performing various cleanup and repair tasks without major issues. The Nextcloud configuration confirms that APCu is set as the local memcache module. Overall, the main issue is a misconfiguration or conflict with the APCu and Redis PHP memcache modules causing fatal errors in Nextcloud.

---[recent tail]---
workflows

$ head -40 /var/log/apache2/nextcloud.local-error.log | grep -i 'memcache'
<<<TSUM>>>
The Apache error log for Nextcloud shows repeated PHP fatal errors related to memcache issues. Specifically:

- The Redis memcache module (OC\Memcache\Redis) is reported as not available for local cache, suggesting the required PHP module is not installed or enabled.
- Similarly, the APCu memcache module (OC\Memcache\APCu) is also reported as unavailable for local cache due to missing or disabled PHP modules.
- Multiple errors indicate attempts to declare the OC\Memcache\APCu class fail because the class name is already in use.
- These errors occur consistently in the file /var/www/nextcloud/lib/private/Memcache/Factory.php around line 81 and in APCu.php on line 12.
- The issues suggest misconfiguration or missing PHP extensions for Redis and APCu memcache in the Nextcloud environment.
<<<TTAIL>>>
che OCMemcacheAPCu not available for local cache (Is the matching PHP module installed and enabled?)\n\n  thrown in /var/www/nextcloud/lib/private/Memcache/Factory.php on line 81
[Thu Aug 28 13:45:59.168640 2025] [php:error] [pid 10577] [client 192.168.56.1:50178] PHP Fatal error:  Uncaught OCP\\HintException: [0]: Memcache OCMemcacheAPCu not available for local cache (Is the matching PHP module installed and enabled?)\n\n  thrown in /var/www/nextcloud/lib/private/Memcache/Factory.php on line 81

$ /usr/bin/php /var/www/nextcloud/occ config:system:get memcache.local
l

\OC\Memcache\APCu

$ php -m | grep -E 'apcu|redis'
apcu
redis

$ php -i | grep -E '^APCu Support|^redis'
APCu Support => Enabled
redis
redis.arrays.algorithm => no value => no value
redis.arrays.auth => no value => no value
redis.arrays.autorehash => 0 => 0
redis.arrays.connecttimeout => 0 => 0
redis.arrays.consistent => 0 => 0
redis.arrays.distributor => no value => no value
redis.arrays.functions => no value => no value
redis.arrays.hosts => no value => no value
redis.arrays.index => 0 => 0
redis.arrays.lazyconnect => 0 => 0
redis.arrays.names => no value => no value
redis.arrays.pconnect => 0 => 0
redis.arrays.previous => no value => no value
redis.arrays.readtimeout => 0 => 0
redis.arrays.retryinterval => 0 => 0
redis.clusters.auth => no value => no value
redis.clusters.cache_slots => 0 => 0
redis.clusters.persistent => 0 => 0
redis.clusters.read_timeout => 0 => 0
redis.clusters.seeds => no value => no value
redis.clusters.timeout => 0 => 0
redis.pconnect.connection_limit => 0 => 0
redis.pconnect.echo_check_liveness => 1 => 1
redis.pconnect.pool_detect_dirty => 0 => 0
redis.pconnect.pool_pattern => no value => no value
redis.pconnect.pool_poll_timeout => 0 => 0
redis.pconnect.pooling_enabled => 1 => 1
redis.session.lock_expire => 0 => 0
redis.session.lock_retries => 10 => 10
redis.session.lock_wait_time => 2000 => 2000
redis.session.locking_enabled => 0 => 0

$ head -40 /var/log/apache2/nextcloud.local-error.log | grep -i 'class.*already declared'


$ grep -i 'class .* already declared' /var/log/apache2/nextcloud.local-error.log | head -20


$ grep -E 'class .* already declared' /var/log/apache2/nextcloud.local-error.log | head -20


$ head -40 /var/log/apache2/nextcloud.local-error.log | grep -i 'class .* already declared'


$ grep -i 'class .* already declared' /var/log/apache2/nextcloud.local-error.log | head -20


$ head -40 /var/log/apache2/nextcloud.local-error.log | grep -i 'class .* already declared'


$ grep -i 'class .* already declared' /var/log/apache2/nextcloud.local-error.log | head -20


$ head -40 /var/log/apache2/nextcloud.local-error.log | grep -i 'class .* already declared'


$ head -40 /var/log/apache2/nextcloud.local-error.log | grep -i 'class .* already declared'


$ grep -E 'class .* already declared' /var/log/apache2/nextcloud.local-error.log | head -20

