The administrator verified the local Apache web server was responding with HTTP 200 OK. They found Nextcloud's Apache error log empty but identified a database connection error ("access denied for user 'USER_OF_DB'@'localhost'") via Nextcloud's occ log tail. MariaDB was running but its logs showed repeated access denied warnings for the same user. The Nextcloud config.php specified the database user as 'USER_OF_DB' with password 'change_this'. Attempts to connect to MariaDB using these credentials failed with access denied error 1698, and querying the MySQL user table showed no existing 'USER_OF_DB'@'localhost' user. The administrator then created the database user with the specified password and granted all privileges on the Nextcloud database. A subsequent Nextcloud maintenance repair command failed due to Redis permission denied errors, traced to Redis socket permissions owned by user and group 'redis' with restrictive access. Overall, the main issues were that the Nextcloud database user did not exist or lacked proper authentication in MariaDB, causing connection failures, and Redis socket permissions prevented Nextcloud from accessing Redis caching.

---[recent tail]---
nection: Upgrade

Last-Modified: Wed, 06 Aug 2025 10:00:30 GMT

ETag: "4-63baf6938d3c4"

Accept-Ranges: bytes

Content-Length: 4

Content-Type: text/html

$ grep -i redis /var/www/nextcloud/config/config.php | head -n 20
'redis' => 
    'host' => '/var/run/redis/redis-server.sock',
  'memcache.local' => '\\OC\\Memcache\\Redis',
  'memcache.distributed' => '\\OC\\Memcache\\Redis',
  'memcache.locking' => '\\OC\\Memcache\\Redis',

$ ls -l /var/run/redis/redis-server.sock
srwxrwx--- 1 redis redis 0 Oct  2 11:19 /var/run/redis/redis-server.sock

$ ps aux | grep redis-server | grep -v grep
redis        585  0.2  0.1  67864 13936 ?        Ssl  11:19   0:24 /usr/bin/redis-server 127.0.0.1:6379

$ ls -ld /var/run/redis /var/run/redis/redis-server.sock
drwxr-sr-x 2 redis redis 80 Oct  2 11:19 /var/run/redis
srwxrwx--- 1 redis redis  0 Oct  2 11:19 /var/run/redis/redis-server.sock

$ curl -I http://localhost | head -n 10
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     4    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
HTTP/1.1 200 OK

Date: Thu, 02 Oct 2025 13:35:52 GMT

Server: Apache/2.4.58 (Ubuntu)

Upgrade: h2,h2c

Connection: Upgrade

Last-Modified: Wed, 06 Aug 2025 10:00:30 GMT

ETag: "4-63baf6938d3c4"

Accept-Ranges: bytes

Content-Length: 4

Content-Type: text/html

$ usermod -a -G redis www-data


$ systemctl restart apache2


$ systemctl restart redis-server


$ /usr/bin/php /var/www/nextcloud/occ maintenance:repair
An unhandled exception has been thrown:
RedisException: Permission denied in /var/www/nextcloud/lib/private/RedisFactory.php:104
Stack trace:
#0 /var/www/nextcloud/lib/private/RedisFactory.php(104): Redis->pconnect()
#1 /var/www/nextcloud/lib/private/RedisFactory.php(148): OC\RedisFactory->create()
#2 /var/www/nextcloud/lib/private/Memcache/Redis.php(53): OC\RedisFactory->getInstance()
#3 /var/www/nextcloud/lib/private/Memcache/Redis.php(59): OC\Memcache\Redis->getCache()
#4 /var/www/nextcloud/lib/private/App/InfoParser.php(32): OC\Memcache\Redis->get()
#5 /var/www/nextcloud/lib/private/App/AppManager.php(780): OC\App\InfoParser->parse()
#6 /var/www/nextcloud/lib/private/App/AppManager.php(765): OC\App\AppManager->getAppInfoByPath()
#7 /var/www/nextcloud/lib/private/AppFramework/App.php(49): OC\App\AppManager->getAppInfo()
#8 /var/www/nextcloud/lib/private/legacy/OC_App.php(111): OC\AppFramework\App::buildAppNamespace()
#9 /var/www/nextcloud/lib/private/AppFramework/Bootstrap/Coordinator.php(76): OC_App::registerAutoloading()
#10 /var/www/nextcloud/lib/private/AppFramework/Bootstrap/Coordinator.php(48): OC\AppFramework\Bootstrap\Coordinator->registerApps()
#11 /var/www/nextcloud/lib/base.php(675): OC\AppFramework\Bootstrap\Coordinator->runInitialRegistration()
#12 /var/www/nextcloud/lib/base.php(1171): OC::init()
#13 /var/www/nextcloud/console.php(28): require_once('...')
#14 /var/www/nextcloud/occ(33): require_once('...')
#15 {main}

$ curl -I http://localhost | head -n 10
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     4    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
HTTP/1.1 200 OK

Date: Thu, 02 Oct 2025 13:36:15 GMT

Server: Apache/2.4.58 (Ubuntu)

Upgrade: h2,h2c

Connection: Upgrade

Last-Modified: Wed, 06 Aug 2025 10:00:30 GMT

ETag: "4-63baf6938d3c4"

Accept-Ranges: bytes

Content-Length: 4

Content-Type: text/html

$ ls -l /var/www/nextcloud | grep config
drwxr-xr-x  2 www-data www-data    4096 Oct  2 13:33 config

$ ls -l /var/run/redis/redis-server.sock
srwxrwx--- 1 redis redis 0 Oct  2 13:36 /var/run/redis/redis-server.sock

$ ls -l /var/run/redis/redis-server.sock
srwxrwx--- 1 redis redis 0 Oct  2 13:36 /var/run/redis/redis-server.sock

$ ls -l /var/run/redis | head -n 20
total 4
-rw-rw---- 1 redis redis 5 Oct  2 13:36 redis-server.pid
srwxrwx--- 1 redis redis 0 Oct  2 13:36 redis-server.sock
